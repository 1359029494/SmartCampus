<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.css" rel="stylesheet" />
		<style type="text/css">
			.main-leader {
				background-color: white;
				overflow: hidden;
			}

			.main-leader div {
				margin-top: 15px;
				float: left;
				width: 33%;
				text-align: center;
			}

			.main-leader div img {
				width: 45%;
			}

			.main-title {
				text-align: center;
				margin-top: 10px;
				background-color: white;
				height: 40px;
				line-height: 40px;
				font-size: 15px;
			}
			.mui-bar-nav{
				background: deepskyblue; height:40px;
				
			}
			.mui-title{
				color: white;
				font-size: 18px;
				line-height: 42px;
			}
			.mui-icon-left-nav{
				color: white;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<h1 class="mui-title">首页</h1>
		</header>

		<div class="mui-content">
			<!--下拉刷新容器-->
			<div id="pullrefresh" class="mui-content mui-scroll-wrapper">
				<div class="mui-scroll">
					<div id="slider" class="mui-slider">
						<div class="mui-slider-group mui-slider-loop">
							<!-- 额外增加的一个节点(循环轮播：第一个节点是最后一张轮播) -->
							<div class="mui-slider-item mui-slider-item-duplicate">
								<a href="#">
									<img src="../images/cbd.jpg">
								</a>
							</div>
							<!-- 第一张 -->
							<div class="mui-slider-item">
								<a href="#">
									<img src="../images/logoone.JPG">
									<p class="mui-slider-title">校园风景</p>
								</a>
							</div>
							<!-- 第二张 -->
							<div class="mui-slider-item">
								<a href="#">
									<img src="../images/logo2.JPG">
									<p class="mui-slider-title">校园风景</p>
								</a>
							</div>
							<!-- 第三张 -->
							<div class="mui-slider-item">
								<a href="#">
									<img src="../images/logo3.JPG">
									<p class="mui-slider-title">校园风景</p>
								</a>
							</div>
							<!-- 第四张 -->
							<div class="mui-slider-item">
								<a href="#">
									<img src="../images/logo4.JPG">
									<p class="mui-slider-title">校园风景</p>
								</a>
							</div>
							<!-- 额外增加的一个节点(循环轮播：最后一个节点是第一张轮播) -->
							<div class="mui-slider-item mui-slider-item-duplicate">
								<a href="#">
									<img src="../images/logoone.JPG">
									<p class="mui-slider-title">静静看这世界</p>
								</a>
							</div>
						</div>
						<div class="mui-slider-indicator">
							<div class="mui-indicator mui-active"></div>
							<div class="mui-indicator"></div>
							<div class="mui-indicator"></div>
							<div class="mui-indicator"></div>
						</div>
					</div>

					<div class="main-leader">
						<div id="repair">
							<img src="../icon/weixiu.png">
							<p>报修</p>
						</div>
						<div>
							<img src="../icon/dingdan.png" id="progress">
							<p>进度查询</p>
						</div>
						<div>
							<img src="../icon/fuwu.png" id="help">
							<p>帮助</p>
						</div>
					</div>
					<div class="main-title">校园安全小知识</div>

					<!-- 数据列表 -->
					<ul class="mui-table-view" id="content">
						<!-- <li class="mui-table-view-cell mui-media">
							<a href="javascript:;">
								<img class="mui-media-object mui-pull-left" src="">
								<div class="mui-media-body">
									幸福
									<p class="mui-ellipsis">能和心爱的人一起睡觉，是件幸福的事情；可是，打呼噜怎么办？</p>
								</div>
							</a>
						</li>
						<li class="mui-table-view-cell mui-media">
							<a href="javascript:;">
								<img class="mui-media-object mui-pull-left" src="">
								<div class="mui-media-body">
									木屋
									<p class="mui-ellipsis">想要这样一间小木屋，夏天挫冰吃瓜，冬天围炉取暖.</p>
								</div>
							</a>
						</li>
						<li class="mui-table-view-cell mui-media">
							<a href="javascript:;">
								<img class="mui-media-object mui-pull-left" src="">
								<div class="mui-media-body">
									CBD
									<p class="mui-ellipsis">烤炉模式的城，到黄昏，如同打翻的调色盘一般.</p>
								</div>
							</a>
						</li> -->
					</ul>
				</div>
			</div>
		</div>
	</body>

	<script src="../js/mui.js"></script>
	<script src="../js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		mui.init({
			pullRefresh: {
				container: "#pullrefresh", //下拉刷新容器标识，querySelector能定位的css选择器均可，比如：id、.class等
				down: {
					style: 'circle', //必选，下拉刷新样式，目前支持原生5+ ‘circle’ 样式
					color: '#2BD009', //可选，默认“#2BD009” 下拉刷新控件颜色
					height: '50', //可选,默认50px.下拉刷新控件的高度,
					range: '100px', //可选 默认100px,控件可下拉拖拽的范围
					offset: '0px', //可选 默认0px,下拉刷新控件的起始位置
					auto: true, //可选,默认false.首次加载自动上拉刷新一次
					callback: down //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
				},
				up: {
					height: 50, //可选.默认50.触发上拉加载拖动距离
					auto: true, //可选,默认false.自动上拉加载一次
					contentrefresh: "正在加载...", //可选，正在加载状态时，上拉加载控件上显示的标题内容
					contentnomore: '没有更多数据了', //可选，请求完毕若没有更多数据时显示的提醒内容；
					callback: up //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
				}
			}
		});

		var url = localStorage.getItem('url')
		var pageNum = 1

		mui.plusReady(function() {
			// 设置系统状态栏背景为蓝色
			plus.navigator.setStatusBarBackground('#00bfff');
		})

		function down() {
			mui.toast('更新了5篇文章');
			mui.get(url + '/api/v1/stuAndtea/findAllKnowledge', {pageNum: pageNum}, function(data) {
				var temp = ''
				for (i in data.data.list) {
					temp += '<li class="mui-table-view-cell mui-media contentLi" id="' + data.data.list[i].id + '">' +
						'<a href="javascript:;">' +
						'<img class="mui-media-object mui-pull-left" src="">' +
						'<div class="mui-media-body">' +
						'' + data.data.list[i].title + '' +
						'<p class="mui-ellipsis">' + data.data.list[i].content + '</p>' +
						'</div>' +
						'</a>' +
						'</li>'
				}
				$('#content').append(temp)

				var li = $('.contentLi')
				for (var i = 0; i < li.length; i++) {
					li.get(i).addEventListener('tap', function() {
						var id = this.getAttribute('id')
						console.log(id)
						mui.openWindow({
							url: "content.html",
							id: "content.html",
							show: {
								autoShow: true, //页面loaded事件发生后自动显示，默认为true
								aniShow: "slide-in-right", //页面显示动画，默认为”slide-in-right“；
								duration: 300 //页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；
							},
							extras: {
								'myid': id
							},
							waiting: {
								autoShow: true, //自动显示等待框，默认为true
								title: '正在加载...', //等待对话框上显示的提示内容
							}
						})
					})
				}
			})
			mui('#pullrefresh').pullRefresh().endPulldownToRefresh(); //完成刷新
		}

		function up() {
			++pageNum
			var mythis = this
			mui.get(url + '/api/v1/stuAndtea/findAllKnowledge', {pageNum: pageNum}, function(data) {
				if(data.data.list.length == 0){
					mythis.endPullupToRefresh(true);
					return
				}
				var temp = ''
				for (i in data.data.list) {
					temp += '<li class="mui-table-view-cell mui-media contentLi" id="' + data.data.list[i].id + '">' +
						'<a href="javascript:;">' +
						'<img class="mui-media-object mui-pull-left" src="">' +
						'<div class="mui-media-body">' +
						'' + data.data.list[i].title + '' +
						'<p class="mui-ellipsis">' + data.data.list[i].content + '</p>' +
						'</div>' +
						'</a>' +
						'</li>'
				}
				$('#content').append(temp)
				
				var li = $('.contentLi')
				for (var i = 0; i < li.length; i++) {
					li.get(i).addEventListener('tap', function() {
						var id = this.getAttribute('id')
						console.log(id)
						mui.openWindow({
							url: "content.html",
							id: "content.html",
							show: {
								autoShow: true, //页面loaded事件发生后自动显示，默认为true
								aniShow: "slide-in-right", //页面显示动画，默认为”slide-in-right“；
								duration: 300 //页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；
							},
							extras: {
								'myid': id
							},
							waiting: {
								autoShow: true, //自动显示等待框，默认为true
								title: '正在加载...', //等待对话框上显示的提示内容
							}
						})
					})
				}
			})
			mui.toast('更新了5篇文章');
			this.endPullupToRefresh(false);
		}



		//获得slider插件对象
		var gallery = mui('.mui-slider');
		gallery.slider({
			interval: 1000 //自动轮播周期，若为0则不自动播放，默认为0；
		});


		//打开进度查询页面
		document.getElementById('progress').addEventListener("tap", function() {
			mui.openWindow({
				url: "progress.html",
				id: "location.html",
				show: {
					autoShow: true, //页面loaded事件发生后自动显示，默认为true
					aniShow: "slide-in-right", //页面显示动画，默认为”slide-in-right“；
					duration: 300 //页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；
				},
				waiting: {
					autoShow: true, //自动显示等待框，默认为true
					title: '正在加载...', //等待对话框上显示的提示内容
				}
			})
		});


		//打开保修界面
		document.getElementById('repair').addEventListener("tap", function() {
			mui.openWindow({
				url: "repair.html",
				id: "repair.html",
				show: {
					autoShow: true, //页面loaded事件发生后自动显示，默认为true
					aniShow: "slide-in-right", //页面显示动画，默认为”slide-in-right“；
					duration: 300 //页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；
				},
				waiting: {
					autoShow: true, //自动显示等待框，默认为true
					title: '正在加载...', //等待对话框上显示的提示内容
				}
			})
		})
		
		document.getElementById('help').addEventListener('tap', function(){
			mui.openWindow({
				url: "help.html",
				id: "help.html",
				show: {
					autoShow: true, //页面loaded事件发生后自动显示，默认为true
					aniShow: "slide-in-right", //页面显示动画，默认为”slide-in-right“；
					duration: 300 //页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；
				},
				waiting: {
					autoShow: true, //自动显示等待框，默认为true
					title: '正在加载...', //等待对话框上显示的提示内容
				}
			})
		})
	</script>

</html>
